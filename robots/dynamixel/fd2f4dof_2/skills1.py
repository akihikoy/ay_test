#!/usr/bin/python
#Running predefined skills by pressing a key.
from dxl_fd2f4dof import *
import time
from kbhit2 import TKBHit

#Setup the device
gripper= TFD2F4DoF()
gripper.Setup()
gripper.EnableTorque()

skills= {
  'a': dict(
    #q_traj= [
      #[0.27765052260730105, 0.2791845033951867, -0.31600004230444206, 0.7194369895183657],
      #[0.1595340019401067, 0.2807184841830723, 0.4924078329112908, 0.7209709703062513],
      #[0.12578642460662257, 0.2807184841830723, 0.7286408742456796, 0.7209709703062513],
      #[0.27765052260730105, 0.2791845033951867, 0.7286408742456796, 0.7209709703062513],
      ##[0.27765052260730105, 0.2791845033951867, -0.31600004230444206, 0.7194369895183657],
      #],
    #t_traj= [1.0,2.0,3.0,4.0] ),
    q_traj= [
      [ 0.0706, 0.2915, 0.3682, 0.7517 ],
      [ -0.1197, 0.2884, 0.5768, 0.7532 ],
      [ -0.2546, 0.2869, 0.4449, 0.7517 ],
      [ 0.0936, 0.2869, 0.7409, 0.7517 ],
      [ 0.0706, 0.2915, 0.3682, 0.7517 ],
      ],
    t_traj= [1.0,2.0,3.0,4.0,5.0] ),
  'g': dict(
    q_traj= [
      #[ 0.2838, 0.2869, -0.2930, 0.7470 ],
      #[ 0.0813, 0.1427, -0.0184, 0.6949 ],
      #[ 0.0491, 0.1887, -0.0614, 0.6796 ],
      [ 0.2761, 0.2915, -0.3620, 0.7501 ],
      [ 0.2025, 0.2915, -0.9894, 0.7501 ],
      [ 0.0322, 0.2915, -0.5630, 0.7517 ],
      [ -0.0629, 0.1825, -0.2071, 0.7010 ],
      ],
    t_traj= [1.0,2.0,3.0,4.0] ),
  'p': dict(
    q_traj= [
      [ -0.1733, 0.1994, -0.2961, 0.6964 ],
      ],
    t_traj= [1.0] ),
  'o': dict(
    q_traj= [
      [ -0.0905, 0.2899, 0.2102, 0.7532 ],
      [ 0.2838, 0.2899, 0.0736, 0.7517 ],
      ],
    t_traj= [1.0,2.0] ),
  'r': dict(
    q_traj= [
      [ -0.2777, 0.2500, 0.6151, 0.6796 ],
      [ -0.3973, 0.2746, -0.4771, 0.6351 ],
      [ -0.0015, 0.2884, -0.4556, 0.7547 ],
      ],
    t_traj= [1.0,2.0,3.0] ),
  }

print skills

try:
  kbhit= TKBHit()
  while True:
    c= kbhit.KBHit()
    if c=='q':  break
    elif c in skills:
      gripper.FollowTrajectory(gripper.JointNames(), skills[c]['q_traj'], skills[c]['t_traj'], blocking=True)
    time.sleep(0.0025)
except KeyboardInterrupt:
  pass

#gripper.DisableTorque()
gripper.Quit()

