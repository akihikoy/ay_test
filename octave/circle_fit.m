XY=[3.432624,-0.677101;  3.378719,-0.607606;  3.320556,-0.541634;  3.258366,-0.479444;  3.192394,-0.421281;  3.122899,-0.367376;  3.050158,-0.317941;  2.974455,-0.273171;  2.896091,-0.233242;  2.815374,-0.198313;  2.732624,-0.168521;  2.648166,-0.143984;  2.562334,-0.124798;  2.475467,-0.111039;  2.387907,-0.102763;  2.300000,-0.100000;  2.212093,-0.102763;  2.124533,-0.111039;  2.037666,-0.124798;  1.951834,-0.143984;  1.867376,-0.168521;  1.784626,-0.198313;  1.703909,-0.233242;  1.625545,-0.273171;  1.549842,-0.317941;  1.477101,-0.367376;  1.407606,-0.421281;  1.341634,-0.479444;  1.279444,-0.541634;  1.221281,-0.607606;  1.167376,-0.677101;  1.117941,-0.749842;  1.073171,-0.825545;  1.033242,-0.903909;  0.998313,-0.984626;  0.968521,-1.067376;  0.943984,-1.151834;  0.924798,-1.237666;  0.911039,-1.324533;  0.902763,-1.412093;  0.900000,-1.500000;  0.902763,-1.587907;  0.911039,-1.675467;  0.924798,-1.762334;  0.943984,-1.848166;  0.968521,-1.932624;  0.998313,-2.015374;  1.033242,-2.096091;  1.073171,-2.174455;  1.117941,-2.250158;  1.167376,-2.322899;  1.221281,-2.392394;  1.279444,-2.458366;  1.341634,-2.520556;  1.407606,-2.578719;  1.477101,-2.632624;  1.549842,-2.682059;  1.625545,-2.726829;  1.703909,-2.766758;  1.784626,-2.801687;  1.867376,-2.831479;  1.951834,-2.856016;  2.037666,-2.875202;  2.124533,-2.888961;  2.212093,-2.897237;  2.300000,-2.900000;  2.387907,-2.897237;  2.475467,-2.888961;  2.562334,-2.875202;  2.648166,-2.856016;  2.732624,-2.831479;  2.815374,-2.801687;  2.896091,-2.766758;  2.974455,-2.726829;  3.050158,-2.682059;  3.122899,-2.632624;  3.192394,-2.578719;  3.258366,-2.520556;  3.320556,-2.458366;  3.378719,-2.392394;  3.432624,-2.322899;  3.482059,-2.250158;  3.526829,-2.174455;  3.566758,-2.096091;  3.601687,-2.015374;  3.631479,-1.932624;  3.656016,-1.848166;  3.675202,-1.762334;  3.688961,-1.675467;  3.697237,-1.587907;  3.700000,-1.500000;  3.697237,-1.412093;  3.688961,-1.324533;  3.675202,-1.237666;  3.656016,-1.151834;  3.631479,-1.067376;  3.601687,-0.984626;  3.566758,-0.903909;  3.526829,-0.825545;  3.482059,-0.749842];

centroid = mean(XY);   % the centroid of the data set

X = XY(:,1) - centroid(1);  %  centering data
Y = XY(:,2) - centroid(2);  %  centering data
Z = X.*X + Y.*Y;
Z
ZXY1 = [Z X Y ones(length(Z),1)];
[U,S,V]=svd(ZXY1,0);
ZXY1
U
S
V
S(4,4)/S(1,1)
if (S(4,4)/S(1,1) < 1e-12)   %  singular case
    A = V(:,4);
else                         %  regular case
    R = mean(ZXY1);
    N = [8*R(1) 4*R(2) 4*R(3) 2; 4*R(2) 1 0 0; 4*R(3) 0 1 0; 2 0 0 0];
    W = V*S*V';
    R
    N
    W
    W*inv(N)*W
    [E,D] = eig(W*inv(N)*W);
    E
    D
    [Dsort,ID] = sort(diag(D));
    ID
    Astar = E(:,ID(2));
    Astar
    A = W\Astar;
    A
end

A
-(A(2:3))'/A(1)/2
A(2)*A(2)+A(3)*A(3)-4*A(1)*A(4)
Par = [-(A(2:3))'/A(1)/2+centroid , sqrt(A(2)*A(2)+A(3)*A(3)-4*A(1)*A(4))/abs(A(1))/2];

%  end   %  HyperSVD

Par
