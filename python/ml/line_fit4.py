#!/usr/bin/python3
#\file    line_fit4.py
#\brief   polyfit test.
#\author  Akihiko Yamaguchi, info@akihikoy.net
#\version 0.1
#\date    Feb.16, 2024
import numpy as np
import numpy.linalg as la
import math
import random
import time
import matplotlib.pyplot as plt

def LineFit(data_x, data_f):
  w= np.polyfit(data_x, data_f, 1)
  return w

if __name__=='__main__':
  data_x= [1708033188.36, 1708033188.43, 1708033188.5, 1708033188.56, 1708033188.63, 1708033188.7, 1708033188.76, 1708033188.83, 1708033188.9, 1708033188.96, 1708033189.03, 1708033189.1, 1708033189.16, 1708033189.23, 1708033189.3, 1708033189.36, 1708033189.43, 1708033189.5, 1708033189.56, 1708033189.63, 1708033189.7, 1708033189.76, 1708033189.83, 1708033189.9, 1708033189.96, 1708033190.03, 1708033190.1, 1708033190.16, 1708033190.23, 1708033190.3, 1708033190.36, 1708033190.43, 1708033190.5, 1708033190.56, 1708033190.63, 1708033190.7, 1708033190.76, 1708033190.83, 1708033190.9, 1708033190.96, 1708033191.03, 1708033191.1, 1708033191.16, 1708033191.23, 1708033191.3, 1708033191.36, 1708033191.43, 1708033191.5, 1708033191.56, 1708033191.63, 1708033191.7, 1708033191.77, 1708033191.83, 1708033191.9, 1708033191.97, 1708033192.03, 1708033192.1, 1708033192.17, 1708033192.23, 1708033192.3, 1708033192.37, 1708033192.43, 1708033192.5, 1708033192.57, 1708033192.63, 1708033192.7, 1708033192.77, 1708033192.83, 1708033192.9, 1708033192.97, 1708033193.03, 1708033193.1, 1708033193.17, 1708033193.23, 1708033193.3, 1708033193.37, 1708033193.43, 1708033193.5, 1708033193.57, 1708033193.63, 1708033193.7, 1708033193.77, 1708033193.83, 1708033193.9, 1708033193.97, 1708033194.03, 1708033194.1, 1708033194.17, 1708033194.23, 1708033194.3, 1708033194.37, 1708033194.43, 1708033194.5, 1708033194.57, 1708033194.63, 1708033194.7, 1708033194.77, 1708033194.83, 1708033194.9, 1708033194.97]
  data_f= [0.370740786869, 0.369202245801, 0.369532422075, 0.36512367811, 0.360517407042, 0.356902346776, 0.350595826739, 0.348571754198, 0.34611100013, 0.341703680931, 0.338376180493, 0.338814469796, 0.334166276805, 0.331315786086, 0.326754583907, 0.323106140965, 0.318700752765, 0.314537063731, 0.309664617578, 0.309621437522, 0.30763567636, 0.305192447036, 0.300412330341, 0.296884568395, 0.289399079145, 0.288360319141, 0.284754091741, 0.279832971197, 0.279684396632, 0.274454120496, 0.271023841291, 0.269413268557, 0.258816535882, 0.262475261573, 0.25707270776, 0.255622354953, 0.246529125142, 0.249464467774, 0.24645133704, 0.239415042817, 0.235951669793, 0.23209881627, 0.227688023516, 0.225102759769, 0.222638421326, 0.219179431853, 0.216928702829, 0.207640036958, 0.204174806497, 0.20249772333, 0.20064313347, 0.195518920391, 0.195382987561, 0.19239027779, 0.185372230488, 0.181117504614, 0.17794209434, 0.180274755433, 0.173855224486, 0.173533427978, 0.166698504524, 0.166274179998, 0.157638748069, 0.156840970625, 0.15461426255, 0.147606188883, 0.145827472703, 0.143716569358, 0.13945365202, 0.139384670215, 0.134682495376, 0.131585124042, 0.125639149994, 0.123200936137, 0.11747981193, 0.116919037242, 0.113904784737, 0.109197593396, 0.104127679565, 0.105426979468, 0.0989688355589, 0.0959028564589, 0.0914091651684, 0.0898927632842, 0.0896061847734, 0.0864461281347, 0.0861524632803, 0.0862355581444, 0.0857433449291, 0.0824381486349, 0.085164594594, 0.081589588311, 0.0802666576279, 0.0819248614289, 0.0800017568836, 0.0766516214552, 0.0801417637228, 0.0811871808824, 0.0825204891548, 0.0756365895195]
  xmin,xmax= np.min(data_x),np.max(data_x)

  markers= ['.', ',', 'o', 'v', '^', '<', '>', '1', '2', '3', '4', '8', 's', 'p', '*', 'h', 'H', '+', 'x', 'D', 'd', '|', '_']
  fig= plt.figure(figsize=(5,5))
  ax= fig.add_subplot(1,1,1,title='line_fit4',xlabel='x',ylabel='y')
  ax.scatter(data_x, data_f, color='blue', s=1, label='data')
  for r in np.arange(0.1,1.1,0.1):
    n= int(len(data_x)*r)

    w= LineFit(data_x[:n], data_f[:n])
    #print 'Computation time[ms]:',(time.time()-t0)*1000.
    print('r={}, w={}'.format(r,w))
    test_x= np.linspace(xmin,data_x[:n][-1],50)
    test_f= np.dot(np.vstack((test_x,np.ones_like(test_x))).T,w)
    ax.plot(test_x, test_f, linewidth=1, label='fit-{}'.format(r))
  ax.legend()
  plt.show()
