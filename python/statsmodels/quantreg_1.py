#!/usr/bin/python
#\file    quantreg_1.py
#\brief   Quantile regression with statsmodels
#\author  Akihiko Yamaguchi, info@akihikoy.net
#\version 0.1
#\date    Feb.29, 2020
import numpy as np
import statsmodels.api as sm
from statsmodels.regression.quantile_regression import QuantReg

if __name__=='__main__':
  data_f= [[3.109999999999985],
          [5.409999999999997],
          [8.159999999999997],
          [4.3300000000000125],
          [8.049999999999983],
          [7.780000000000001],
          [9.139999999999986],
          [5.320000000000022],
          [3.8499999999999943],
          [2.289999999999992],
          [2.719999999999999],
          [8.219999999999999],
          [7.689999999999998],
          [6.649999999999977],
          [7.5] ]
  data_x= [[0.055081333333333336, 0.03850409056244104, 0.014406587551462513, -0.2862249711223982, -0.2862249711223982, 0.3421522668093765],
          [0.055081333333333336, 0.03448434911665442, 0.008151836665812807, 0.11726625279111824, 0.11726625279111824, 0.7719965752858745],
          [0.045489333333333326, 0.03347116841919466, 0.008462077376798424, 0.022463494199869517, 0.022463494199869517, 0.004213862646420752],
          [0.049268, 0.021859359514672695, 0.0019211160860064269, -0.17103874409900743, -0.17103874409900743, -0.054628901373184095],
          [0.04621599999999999, 0.03870238637692926, 0.011549967987492301, -0.28426356405414943, -0.28426356405414943, -0.10168519085676413],
          [0.06728933333333334, 0.02631824044107963, 0.006559262682831748, -0.04218211243417798, -0.04218211243417798, -0.009108909668828194],
          [0.055081333333333336, 0.0343333998579121, 0.0016731810289882442, 0.16971312166363747, 0.16971312166363747, 0.6685057782476165],
          [0.06031333333333333, 0.03910217398879195, 0.01006256727164606, -0.0714725176040562, -0.0714725176040562, -0.6923722625721858],
          [0.04461733333333333, 0.039290924339443305, 0.0054453074214751455, 0.02730160037218635, 0.02730160037218635, 0.7458319715257576],
          [0.050430666666666665, 0.02924489833092551, 0.013317870745890912, 0.11429599795028716, 0.11429599795028716, -0.3104770125940892],
          [0.042291999999999996, 0.03532789118165129, 0.01942514767554277, -0.646311786712599, -0.646311786712599, -0.00590368777149421],
          [0.046652, 0.03904150307525044, 0.002881339228931461, 0.07548601305400272, 0.07548601305400272, -0.4346644449107354],
          [0.05115733333333333, 0.026746636287813586, 0.004403661364565186, -0.08564773124143436, -0.08564773124143436, -0.008704999627954273],
          [0.04287333333333333, 0.03890437120429957, 0.009704001762875326, -0.3751415409525848, -0.3751415409525848, 0.2472233383965432],
          [0.04490799999999999, 0.02368131550430402, 0.0071991790129223255, -0.04132439463304245, -0.04132439463304245, -0.15630671055239095] ]

  data_x= [x[:-2]+x[-1:] for x in data_x]

  Theta= np.array([[1.0]+x for x in data_x])
  print '\n'.join(map(str,[[len(x),len(theta),len(f)] for x,theta,f in zip(data_x,Theta,data_f)]))
  #quant_reg= QuantReg(data_f, Theta)
  quant_reg= QuantReg(np.array(data_f), np.array(Theta))
  fit1= quant_reg.fit(q=0.1)
  fit5= quant_reg.fit(q=0.5)
  fit9= quant_reg.fit(q=0.95)
  w1= fit1.params
  w5= fit5.params
  w9= fit9.params
  print fit9.summary()
  print 'Parameters w1:',w1
  print 'Parameters w5:',w5
  print 'Parameters w9:',w9

